{"version":3,"sources":["poisson-process.js"],"names":["root","factory","define","amd","exports","PoissonProcess","this","sample","mean","Math","log","random","IntervalError","msg","name","message","prototype","Error","TriggerFunctionError","Process","interval","fn","timeout","create","averageIntervalMs","triggerFunction","start","dt","that","setTimeout","stop","clearTimeout","extension","version"],"mappings":"CAIC,SAAUA,EAAMC,GACf,YACsB,mBAAXC,SAAyBA,OAAOC,IAEzCD,QAAQ,WAAYD,GAGpBA,EAF4B,gBAAZG,SAERA,QAGCJ,EAAKK,oBAEhBC,KAAM,SAAUF,GAChB,YAOA,IAAIG,GAAS,SAAUC,GAOrB,OAAQC,KAAKC,IAAID,KAAKE,UAAYH,GAQhCI,EAAgB,SAAUC,GAC5BP,KAAKQ,KAAO,gBACZR,KAAKS,QAAWF,GAAO,GAEzBD,GAAcI,UAAY,GAAIC,MAE9B,IAAIC,GAAuB,SAAUL,GACnCP,KAAKQ,KAAO,uBACZR,KAAKS,QAAWF,GAAO,GAEzBK,GAAqBF,UAAY,GAAIC,MAQrC,IAAIE,GAAU,SAAUC,EAAUC,GAChC,GAAwB,gBAAbD,GACT,KAAM,IAAIR,GAAcQ,EAAW,uBAErC,IAAkB,kBAAPC,GACT,KAAM,IAAIH,GAAqBG,EAAK,yBAEtC,IAAID,EAAW,EACb,KAAM,IAAIR,GAAcQ,EAAW,oCAErCd,MAAKc,SAAWA,EAChBd,KAAKe,GAAKA,EACVf,KAAKgB,QAAU,KAGjBlB,GAAQmB,OAAS,SAAUC,EAAmBC,GAC5C,MAAO,IAAIN,GAAQK,EAAmBC,IASxCN,EAAQH,UAAUU,MAAQ,WACxB,GAAIC,GAAKpB,EAAOD,KAAKc,UACjBQ,EAAOtB,IACXA,MAAKgB,QAAUO,WAAW,WACxBD,EAAKF,QACLE,EAAKP,MACJM,IAGLR,EAAQH,UAAUc,KAAO,WACvBC,aAAazB,KAAKgB,UASpBlB,EAAQG,OAASA,EAWjBH,EAAQ4B,UAAYb,EAAQH,UAO5BZ,EAAQ6B,QAAU","file":"poisson-process.min.js","sourcesContent":["// *****************************\n// UMD pattern commonjsStrict.js\n// https://github.com/umdjs/umd\n// *****************************\n(function (root, factory) {\n  'use strict';\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define(['exports'], factory);\n  } else if (typeof exports === 'object') {\n    // CommonJS & Node\n    factory(exports);\n  } else {\n    // Browser globals\n    factory((root.PoissonProcess = {}));\n  }\n}(this, function (exports) {\n  'use strict';\n\n\n\n  // ****************\n  // Helper functions\n  // ****************\n  var sample = function (mean) {\n    // Generate exponentially distributed variate.\n    //\n    // Inter-arrival times of events in Poisson process\n    // are exponentially distributed.\n    // mean = 1 / rate\n    // Math.log(x) = natural logarithm of x\n    return -Math.log(Math.random()) * mean;\n  };\n\n\n\n  // **********\n  // Exceptions\n  // **********\n  var IntervalError = function (msg) {\n    this.name = 'IntervalError';\n    this.message = (msg || '');\n  };\n  IntervalError.prototype = new Error();\n\n  var TriggerFunctionError = function (msg) {\n    this.name = 'TriggerFunctionError';\n    this.message = (msg || '');\n  };\n  TriggerFunctionError.prototype = new Error();\n\n\n\n  // ***********\n  // Constructor\n  // ***********\n\n  var Process = function (interval, fn) {\n    if (typeof interval !== 'number') {\n      throw new IntervalError(interval + ' should be a number.');\n    }\n    if (typeof fn !== 'function') {\n      throw new TriggerFunctionError(fn + ' should be a function.');\n    }\n    if (interval < 0) {\n      throw new IntervalError(interval + ' should be a non-negative number.');\n    }\n    this.interval = interval;\n    this.fn = fn;\n    this.timeout = null;\n  };\n\n  exports.create = function (averageIntervalMs, triggerFunction) {\n    return new Process(averageIntervalMs, triggerFunction);\n  };\n\n\n\n  // ****************\n  // Instance methods\n  // ****************\n\n  Process.prototype.start = function () {\n    var dt = sample(this.interval);\n    var that = this;\n    this.timeout = setTimeout(function () {\n      that.start();\n      that.fn();\n    }, dt);\n  };\n\n  Process.prototype.stop = function () {\n    clearTimeout(this.timeout);\n  };\n\n\n\n  // **************\n  // Module methods\n  // **************\n\n  exports.sample = sample;\n\n\n\n  // *************\n  // Extendability\n  // *************\n  // Usage\n  //   var p = PoissonProcess.create(time, fn)\n  //   PoissonProcess.extension.myFunction = function (...) {...}\n  //   p.myFunction()\n  exports.extension = Process.prototype;\n\n\n\n  // *******\n  // Version\n  // *******\n  exports.version = '0.2.2';\n\n}));\n"]}